Originally posted by user "deif" on the Arduino site, I've done minor edits and then placed the code here as a library.

You can find the original sketch by deif here as "sketch.txt".

I've used the code for my spectrum analyzer with video output:

http://blurtime.blogspot.com/2010_11_01_archive.html